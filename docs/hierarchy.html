---

title: Hierarchy

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\04_hierarchy.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PCTHierarchy" class="doc_header"><code>class</code> <code>PCTHierarchy</code><a href="https://github.com/perceptualrobots/pct/tree/master/pct/hierarchy.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PCTHierarchy</code>(<strong><code>levels</code></strong>=<em><code>0</code></em>, <strong><code>cols</code></strong>=<em><code>0</code></em>, <strong><code>pre</code></strong>=<em><code>None</code></em>, <strong><code>post</code></strong>=<em><code>None</code></em>, <strong><code>name</code></strong>=<em><code>'pcthierarchy'</code></em>, <strong><code>clear_names</code></strong>=<em><code>True</code></em>, <strong><code>links</code></strong>=<em><code>'single'</code></em>, <strong><code>history</code></strong>=<em><code>False</code></em>, <strong><code>build</code></strong>=<em><code>True</code></em>, <strong>**<code>pargs</code></strong>)</p>
</blockquote>
<p>A hierarchical perceptual control system, of PCTNodes.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Creating-a-Hierarchy">Creating a Hierarchy<a class="anchor-link" href="#Creating-a-Hierarchy"> </a></h2><p>Create a hierarchy by defining the number of rows (levels) and columns.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pre</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;precon&#39;</span><span class="p">)</span>
<span class="n">post</span><span class="o">=</span><span class="n">Constant</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;postcon&#39;</span><span class="p">)</span>
<span class="n">hpct</span> <span class="o">=</span> <span class="n">PCTHierarchy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="p">[</span><span class="n">pre</span><span class="p">],</span> <span class="n">post</span><span class="o">=</span><span class="p">[</span><span class="n">post</span><span class="p">],</span> <span class="n">history</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clear_names</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">links</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)</span>
<span class="n">hpct</span><span class="o">.</span><span class="n">hierarchy</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[[&lt;pct.nodes.PCTNode at 0x287d19e6b08&gt;,
  &lt;pct.nodes.PCTNode at 0x287d19e6cc8&gt;,
  &lt;pct.nodes.PCTNode at 0x287d19e6e88&gt;],
 [&lt;pct.nodes.PCTNode at 0x287d19c3808&gt;,
  &lt;pct.nodes.PCTNode at 0x287d19c3248&gt;,
  &lt;pct.nodes.PCTNode at 0x287d1af8e48&gt;],
 [&lt;pct.nodes.PCTNode at 0x287d1af8808&gt;,
  &lt;pct.nodes.PCTNode at 0x287d1af8c48&gt;,
  &lt;pct.nodes.PCTNode at 0x287d1af8d08&gt;]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a hierarchy from a configuration.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">PCTHierarchy</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">hpct</span><span class="o">.</span><span class="n">get_config</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">h</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span> <span class="o">==</span> <span class="n">hpct</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Viewing-a-Hierarchy">Viewing a Hierarchy<a class="anchor-link" href="#Viewing-a-Hierarchy"> </a></h2><p>The hierarchy details can be viewed as a summary.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hpct</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>pcthierarchy1 PCTHierarchy
**************************
PRE: precon Constant | 5 
Level 0
level0col01 PCTNode
----------------------------
REF: weighted_sum4 WeightedSum | 0 | links  proportional7 proportional8 proportional9 
PER: variable2 Variable | 0 
COM: subtract4 Subtract | 0 | links  weighted_sum4 variable2 
OUT: proportional4 Proportional | gain 10 | 0 | links  subtract4 
----------------------------
level0col11 PCTNode
----------------------------
REF: weighted_sum5 WeightedSum | 0 | links  proportional7 proportional8 proportional9 
PER: variable3 Variable | 0 
COM: subtract5 Subtract | 0 | links  weighted_sum5 variable3 
OUT: proportional5 Proportional | gain 10 | 0 | links  subtract5 
----------------------------
level0col2 PCTNode
----------------------------
REF: weighted_sum6 WeightedSum | 0 | links  proportional7 proportional8 proportional9 
PER: variable4 Variable | 0 
COM: subtract6 Subtract | 0 | links  weighted_sum6 variable4 
OUT: proportional6 Proportional | gain 10 | 0 | links  subtract6 
----------------------------
Level 1
level1col01 PCTNode
----------------------------
REF: weighted_sum8 WeightedSum | 0 | links  proportional10 proportional11 proportional12 
PER: weighted_sum7 WeightedSum | 0 | links  variable2 variable3 variable4 
COM: subtract7 Subtract | 0 | links  weighted_sum8 weighted_sum7 
OUT: proportional7 Proportional | gain 10 | 0 | links  subtract7 
----------------------------
level1col11 PCTNode
----------------------------
REF: weighted_sum10 WeightedSum | 0 | links  proportional10 proportional11 proportional12 
PER: weighted_sum9 WeightedSum | 0 | links  variable2 variable3 variable4 
COM: subtract8 Subtract | 0 | links  weighted_sum10 weighted_sum9 
OUT: proportional8 Proportional | gain 10 | 0 | links  subtract8 
----------------------------
level1col2 PCTNode
----------------------------
REF: weighted_sum12 WeightedSum | 0 | links  proportional10 proportional11 proportional12 
PER: weighted_sum11 WeightedSum | 0 | links  variable2 variable3 variable4 
COM: subtract9 Subtract | 0 | links  weighted_sum12 weighted_sum11 
OUT: proportional9 Proportional | gain 10 | 0 | links  subtract9 
----------------------------
Level 2
level2col0 PCTNode
----------------------------
REF: constant2 Constant | 1 
PER: weighted_sum13 WeightedSum | 0 | links  weighted_sum7 weighted_sum9 weighted_sum11 
COM: subtract10 Subtract | 0 | links  constant2 weighted_sum13 
OUT: proportional10 Proportional | gain 10 | 0 | links  subtract10 
----------------------------
level2col1 PCTNode
----------------------------
REF: constant3 Constant | 1 
PER: weighted_sum14 WeightedSum | 0 | links  weighted_sum7 weighted_sum9 weighted_sum11 
COM: subtract11 Subtract | 0 | links  constant3 weighted_sum14 
OUT: proportional11 Proportional | gain 10 | 0 | links  subtract11 
----------------------------
level2col2 PCTNode
----------------------------
REF: constant4 Constant | 1 
PER: weighted_sum15 WeightedSum | 0 | links  weighted_sum7 weighted_sum9 weighted_sum11 
COM: subtract12 Subtract | 0 | links  constant4 weighted_sum15 
OUT: proportional12 Proportional | gain 10 | 0 | links  subtract12 
----------------------------
POST: postcon Constant | 10 
**************************
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The hierarchy details can be viewed as a configuration. That configuration can be used to create a hierarchy, as shown above.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hpct</span><span class="o">.</span><span class="n">get_config</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;type&#39;: &#39;PCTHierarchy&#39;,
 &#39;name&#39;: &#39;pcthierarchy1&#39;,
 &#39;pre&#39;: {&#39;pre0&#39;: {&#39;type&#39;: &#39;Constant&#39;,
   &#39;name&#39;: &#39;precon&#39;,
   &#39;value&#39;: 5,
   &#39;links&#39;: {}}},
 &#39;levels&#39;: {&#39;level0&#39;: {&#39;level&#39;: 0,
   &#39;nodes&#39;: {&#39;col0&#39;: {&#39;col&#39;: 0,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level0col01&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum4&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;proportional7&#39;, 1: &#39;proportional8&#39;, 2: &#39;proportional9&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Variable&#39;,
        &#39;name&#39;: &#39;variable2&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {}}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract4&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum4&#39;, 1: &#39;variable2&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional4&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract4&#39;},
        &#39;gain&#39;: 10}}}},
    &#39;col1&#39;: {&#39;col&#39;: 1,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level0col11&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum5&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;proportional7&#39;, 1: &#39;proportional8&#39;, 2: &#39;proportional9&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Variable&#39;,
        &#39;name&#39;: &#39;variable3&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {}}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract5&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum5&#39;, 1: &#39;variable3&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional5&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract5&#39;},
        &#39;gain&#39;: 10}}}},
    &#39;col2&#39;: {&#39;col&#39;: 2,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level0col2&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum6&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;proportional7&#39;, 1: &#39;proportional8&#39;, 2: &#39;proportional9&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Variable&#39;,
        &#39;name&#39;: &#39;variable4&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {}}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract6&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum6&#39;, 1: &#39;variable4&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional6&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract6&#39;},
        &#39;gain&#39;: 10}}}}}},
  &#39;level1&#39;: {&#39;level&#39;: 1,
   &#39;nodes&#39;: {&#39;col0&#39;: {&#39;col&#39;: 0,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level1col01&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum8&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;proportional10&#39;,
         1: &#39;proportional11&#39;,
         2: &#39;proportional12&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum7&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;variable2&#39;, 1: &#39;variable3&#39;, 2: &#39;variable4&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract7&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum8&#39;, 1: &#39;weighted_sum7&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional7&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract7&#39;},
        &#39;gain&#39;: 10}}}},
    &#39;col1&#39;: {&#39;col&#39;: 1,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level1col11&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum10&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;proportional10&#39;,
         1: &#39;proportional11&#39;,
         2: &#39;proportional12&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum9&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;variable2&#39;, 1: &#39;variable3&#39;, 2: &#39;variable4&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract8&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum10&#39;, 1: &#39;weighted_sum9&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional8&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract8&#39;},
        &#39;gain&#39;: 10}}}},
    &#39;col2&#39;: {&#39;col&#39;: 2,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level1col2&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum12&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;proportional10&#39;,
         1: &#39;proportional11&#39;,
         2: &#39;proportional12&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum11&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;variable2&#39;, 1: &#39;variable3&#39;, 2: &#39;variable4&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract9&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum12&#39;, 1: &#39;weighted_sum11&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional9&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract9&#39;},
        &#39;gain&#39;: 10}}}}}},
  &#39;level2&#39;: {&#39;level&#39;: 2,
   &#39;nodes&#39;: {&#39;col0&#39;: {&#39;col&#39;: 0,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level2col0&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Constant&#39;,
        &#39;name&#39;: &#39;constant2&#39;,
        &#39;value&#39;: 1,
        &#39;links&#39;: {}}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum13&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum7&#39;, 1: &#39;weighted_sum9&#39;, 2: &#39;weighted_sum11&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract10&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;constant2&#39;, 1: &#39;weighted_sum13&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional10&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract10&#39;},
        &#39;gain&#39;: 10}}}},
    &#39;col1&#39;: {&#39;col&#39;: 1,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level2col1&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Constant&#39;,
        &#39;name&#39;: &#39;constant3&#39;,
        &#39;value&#39;: 1,
        &#39;links&#39;: {}}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum14&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum7&#39;, 1: &#39;weighted_sum9&#39;, 2: &#39;weighted_sum11&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract11&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;constant3&#39;, 1: &#39;weighted_sum14&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional11&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract11&#39;},
        &#39;gain&#39;: 10}}}},
    &#39;col2&#39;: {&#39;col&#39;: 2,
     &#39;node&#39;: {&#39;type&#39;: &#39;PCTNode&#39;,
      &#39;name&#39;: &#39;level2col2&#39;,
      &#39;refcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Constant&#39;,
        &#39;name&#39;: &#39;constant4&#39;,
        &#39;value&#39;: 1,
        &#39;links&#39;: {}}},
      &#39;percoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;WeightedSum&#39;,
        &#39;name&#39;: &#39;weighted_sum15&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;weighted_sum7&#39;, 1: &#39;weighted_sum9&#39;, 2: &#39;weighted_sum11&#39;},
        &#39;weights&#39;: array([1., 1., 1.])}},
      &#39;comcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Subtract&#39;,
        &#39;name&#39;: &#39;subtract12&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;constant4&#39;, 1: &#39;weighted_sum15&#39;}}},
      &#39;outcoll&#39;: {&#39;0&#39;: {&#39;type&#39;: &#39;Proportional&#39;,
        &#39;name&#39;: &#39;proportional12&#39;,
        &#39;value&#39;: 0,
        &#39;links&#39;: {0: &#39;subtract12&#39;},
        &#39;gain&#39;: 10}}}}}}},
 &#39;post&#39;: {&#39;post0&#39;: {&#39;type&#39;: &#39;Constant&#39;,
   &#39;name&#39;: &#39;postcon&#39;,
   &#39;value&#39;: 10,
   &#39;links&#39;: {}}}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get the output function, which will be the output function of the last node, or the last item of the post-processor functions, if present.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">link</span> <span class="o">=</span> <span class="n">hpct</span><span class="o">.</span><span class="n">get_output_function</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">get_config</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;type&#39;: &#39;Constant&#39;, &#39;name&#39;: &#39;postcon&#39;, &#39;value&#39;: 10, &#39;links&#39;: {}}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The hierarhcy can also be viewed graphically as a network of connected nodes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">networkx.drawing.nx_agraph</span> <span class="kn">import</span> <span class="n">graphviz_layout</span>

<span class="n">FunctionsList</span><span class="o">.</span><span class="n">getInstance</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">ahpct</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">ahpct</span> <span class="o">=</span> <span class="n">PCTHierarchy</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">links</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)</span>

<span class="n">test</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">if</span> <span class="n">test</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">ahpct</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">graphviz_layout</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">prog</span><span class="o">=</span><span class="s1">&#39;dot&#39;</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>  <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="k">if</span> <span class="n">test</span> <span class="o">==</span><span class="mi">2</span><span class="p">:</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">ahpct</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">multipartite_layout</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>  <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="k">if</span> <span class="n">test</span> <span class="o">==</span><span class="mi">3</span><span class="p">:</span>
    <span class="n">ahpct</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span><span class="c1"># with_labels=True, font_weight=&#39;bold&#39;, node_color=&#39;red&#39;,  node_size=500, layout=&#39;dot&#39;):</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-4-bf22a19e24b9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">     17</span> 
<span class="ansi-green-fg">     18</span> <span class="ansi-green-intense-fg ansi-bold">if</span> test <span class="ansi-yellow-intense-fg ansi-bold">==</span><span class="ansi-cyan-intense-fg ansi-bold">3</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 19</span><span class="ansi-yellow-intense-fg ansi-bold">     </span>ahpct<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-red-intense-fg ansi-bold"># with_labels=True, font_weight=&#39;bold&#39;, node_color=&#39;red&#39;,  node_size=500, layout=&#39;dot&#39;):</span>

<span class="ansi-green-intense-fg ansi-bold">~\Google Drive\nbdev\pct\pct\hierarchy.py</span> in <span class="ansi-cyan-fg">draw</span><span class="ansi-blue-intense-fg ansi-bold">(self, with_labels, font_weight, node_color, node_size, layout)</span>
<span class="ansi-green-fg">    153</span>     <span class="ansi-green-intense-fg ansi-bold">def</span> draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>self<span class="ansi-yellow-intense-fg ansi-bold">,</span> with_labels<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">True</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> font_weight<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;bold&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> node_color<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;red&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span>  node_size<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-cyan-intense-fg ansi-bold">500</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> layout<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;dot&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    154</span>         graph <span class="ansi-yellow-intense-fg ansi-bold">=</span> self<span class="ansi-yellow-intense-fg ansi-bold">.</span>graph<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 155</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>pos<span class="ansi-yellow-intense-fg ansi-bold">=</span>graphviz_layout<span class="ansi-yellow-intense-fg ansi-bold">(</span>g<span class="ansi-yellow-intense-fg ansi-bold">,</span> prog<span class="ansi-yellow-intense-fg ansi-bold">=</span>layout<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    156</span>         nx<span class="ansi-yellow-intense-fg ansi-bold">.</span>draw<span class="ansi-yellow-intense-fg ansi-bold">(</span>g<span class="ansi-yellow-intense-fg ansi-bold">,</span> pos<span class="ansi-yellow-intense-fg ansi-bold">=</span>pos<span class="ansi-yellow-intense-fg ansi-bold">,</span> with_labels<span class="ansi-yellow-intense-fg ansi-bold">=</span>with_labels<span class="ansi-yellow-intense-fg ansi-bold">,</span> font_weight<span class="ansi-yellow-intense-fg ansi-bold">=</span>font_weight<span class="ansi-yellow-intense-fg ansi-bold">,</span> node_color<span class="ansi-yellow-intense-fg ansi-bold">=</span>node_color<span class="ansi-yellow-intense-fg ansi-bold">,</span>  node_size<span class="ansi-yellow-intense-fg ansi-bold">=</span>node_size<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    157</span> 

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;graphviz_layout&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Running-a-hierarchy">Running a hierarchy<a class="anchor-link" href="#Running-a-hierarchy"> </a></h2><p>The hierachy can be run one by calling itself. The verbose flag will print the computations to the screen.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hpct</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>5.000 
level0col01 0.000 0.000 0.000 0.000 
level0col11 0.000 0.000 0.000 0.000 
level0col2 0.000 0.000 0.000 0.000 
level1col01 0.000 0.000 0.000 0.000 
level1col11 0.000 0.000 0.000 0.000 
level1col2 0.000 0.000 0.000 0.000 
level2col0 1.000 0.000 1.000 10.000 
level2col1 1.000 0.000 1.000 10.000 
level2col2 1.000 0.000 1.000 10.000 
10.000 

</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A hierarchy can be executed with the "run()" method, providing the number of iterations to run.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hpct1</span> <span class="o">=</span> <span class="n">PCTHierarchy</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="p">[</span><span class="n">pre</span><span class="p">],</span> <span class="n">post</span><span class="o">=</span><span class="p">[</span><span class="n">post</span><span class="p">],</span> <span class="n">history</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">links</span><span class="o">=</span><span class="s2">&quot;dense&quot;</span><span class="p">)</span>
<span class="n">hpct1</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Viewing-Data">Viewing Data<a class="anchor-link" href="#Viewing-Data"> </a></h2><p>If the hierarchy is created with the "history" flag equal to True, the data can be retrieved for each node. The node is accessed by specifying the row and column within the hierarchy.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">hpct1</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">hpct1</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;refcoll&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;weighted_sum6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">]},</span> <span class="s1">&#39;percoll&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;weighted_sum5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]},</span> <span class="s1">&#39;comcoll&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;subtract4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">]},</span> <span class="s1">&#39;outcoll&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;proportional4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">]}}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;refcoll&#39;: {&#39;weighted_sum6&#39;: [0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0]}, &#39;percoll&#39;: {&#39;weighted_sum5&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, &#39;comcoll&#39;: {&#39;subtract4&#39;: [0.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0, 30.0]}, &#39;outcoll&#39;: {&#39;proportional4&#39;: [0.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0]}}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Build a hierarchy by adding nodes and functions manually.</p>
<p>Create an empty hierarchy.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myhpct</span> <span class="o">=</span> <span class="n">PCTHierarchy</span><span class="p">()</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">build</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>pcthierarchy PCTHierarchy
**************************
PRE: None
POST: None
**************************
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Add a node. Then nodes at particular positions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myhpct</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">PCTNode</span><span class="p">())</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">PCTNode</span><span class="p">(),</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">PCTNode</span><span class="p">(),</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">build</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>pcthierarchy PCTHierarchy
**************************
PRE: None
Level 0
pctnode2 PCTNode
----------------------------
REF: constant2 Constant | 1 
PER: variable2 Variable | 0 
COM: subtract2 Subtract | 0 
OUT: proportional2 Proportional | gain 10 | 0 
----------------------------
pctnode PCTNode
----------------------------
REF: constant Constant | 1 
PER: variable Variable | 0 
COM: subtract Subtract | 0 
OUT: proportional Proportional | gain 10 | 0 
----------------------------
Level 1
pctnode1 PCTNode
----------------------------
REF: constant1 Constant | 1 
PER: variable1 Variable | 0 
COM: subtract1 Subtract | 0 
OUT: proportional1 Proportional | gain 10 | 0 
----------------------------
POST: None
**************************
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Replace functions at particular positions in the hierarchy.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myhpct</span><span class="o">.</span><span class="n">insert_function</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;perception&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">Proportional</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;prop2&quot;</span><span class="p">))</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">insert_function</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;perception&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">WeightedSum</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;wsum&quot;</span><span class="p">))</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">insert_function</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">collection</span><span class="o">=</span><span class="s2">&quot;reference&quot;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">Proportional</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;passthru&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Add pre and post processor functions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myhpct</span><span class="o">.</span><span class="n">add_preprocessor</span><span class="p">(</span><span class="n">Constant</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cons1&quot;</span><span class="p">))</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">add_preprocessor</span><span class="p">(</span><span class="n">Proportional</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;prop1&quot;</span><span class="p">))</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">add_postprocessor</span><span class="p">(</span><span class="n">Proportional</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;postprop1&quot;</span><span class="p">))</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">add_postprocessor</span><span class="p">(</span><span class="n">Proportional</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;postprop2&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Link the functions together.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myhpct</span><span class="o">.</span><span class="n">set_links</span><span class="p">(</span><span class="s2">&quot;prop1&quot;</span><span class="p">,</span> <span class="s2">&quot;cons1&quot;</span><span class="p">)</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">set_links</span><span class="p">(</span><span class="s2">&quot;prop2&quot;</span><span class="p">,</span> <span class="s2">&quot;prop1&quot;</span><span class="p">)</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">set_links</span><span class="p">(</span><span class="s2">&quot;wsum&quot;</span><span class="p">,</span> <span class="s2">&quot;prop2&quot;</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">)</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">set_links</span><span class="p">(</span><span class="s2">&quot;passthru&quot;</span><span class="p">,</span> <span class="s2">&quot;proportional1&quot;</span><span class="p">)</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">set_links</span><span class="p">(</span><span class="s2">&quot;postprop1&quot;</span><span class="p">,</span> <span class="s2">&quot;proportional&quot;</span><span class="p">)</span>
<span class="n">myhpct</span><span class="o">.</span><span class="n">set_links</span><span class="p">(</span><span class="s2">&quot;postprop2&quot;</span><span class="p">,</span> <span class="s2">&quot;postprop1&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myhpct</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>pcthierarchy PCTHierarchy
**************************
PRE: cons1 Constant | 1 
prop1 Proportional | gain 5 | 0 | links  cons1 
Level 0
pctnode2 PCTNode
----------------------------
REF: constant2 Constant | 1 
PER: prop2 Proportional | gain 3 | 0 | links  prop1 
COM: subtract2 Subtract | 0 | links  constant2 prop2 
OUT: proportional2 Proportional | gain 10 | 0 | links  subtract2 
----------------------------
pctnode PCTNode
----------------------------
REF: passthru Proportional | gain 1 | 0 | links  proportional1 
PER: variable Variable | 0 
COM: subtract Subtract | 0 | links  passthru variable 
OUT: proportional Proportional | gain 10 | 0 | links  subtract 
----------------------------
Level 1
pctnode1 PCTNode
----------------------------
REF: constant1 Constant | 1 
PER: wsum WeightedSum | 0 | links  prop2 variable 
COM: subtract1 Subtract | 0 | links  constant1 wsum 
OUT: proportional1 Proportional | gain 10 | 0 | links  subtract1 
----------------------------
POST: postprop1 Proportional | gain 5 | 0 | links  proportional 
postprop2 Proportional | gain 5 | 0 | links  postprop1 
**************************
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define the order in which the node will be processed.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">myhpct</span><span class="o">.</span><span class="n">set_order</span><span class="p">([</span><span class="s2">&quot;pctnode2&quot;</span><span class="p">,</span> <span class="s2">&quot;pctnode1&quot;</span><span class="p">,</span> <span class="s2">&quot;pctnode&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run the hierarchy once.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">myhpct</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">out</span> <span class="o">==</span> <span class="o">-</span><span class="mi">35000</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1.000 5.000 
pctnode2 1.000 15.000 -14.000 -140.000 
pctnode1 1.000 15.000 -14.000 -140.000 
pctnode -140.000 0.000 -140.000 -1400.000 
-7000.000 -35000.000 

-35000.0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

